==========
User guide
==========


***************
Access AiiDAlab
***************

As a user, you have three options to access AiiDAlab:

 1. Log into one of the `open AiiDAlab servers <https://materialscloud.org/aiidalab>`_.
 2. Download the `Quantum Mobile Virtual Machine <https://quantum-mobile.readthedocs.io/>`_, open a terminal and run ``aiidalab``.
 3. Run the AiiDAlab docker container on your local machine (see below).

.. _usage:run-locally:

Run AiiDAlab locally
====================

To run AiiDAlab on your own workstation or laptop you can either

 - run the image directly with: ```docker run aiidalab-docker-stack -p 8888:8888```, or
 - *(recommended)* use the :ref:`aiidalab-launch <usage:aiidalab-launch>` tool which is a thin docker wrapper.

.. _usage:aiidalab-launch:

AiiDAlab Launch
---------------

To use AiiDAlab launch you will have to


#. `Install Docker on your workstation or laptop. <https://docs.docker.com/get-docker/>`_
#. Install AiiDAlab launch with `pipx <https://pypa.github.io/pipx/installation/>`_ (**recommended**):

   .. code-block:: console

      pipx install aiidalab-launch

   Or directly with pip (``pip install aiidalab-launch``).

#. Start AiiDAlab with

   .. code-block:: console

       aiidalab-launch start

#. Follow the instructions on screen to open AiiDAlab in the browser.

See ``aiidalab-launch --help`` for detailed help.

Instance Management
^^^^^^^^^^^^^^^^^^^

You can inspect the status of all configured AiiDAlab profiles with:

.. code-block:: console

   aiidalab-launch status

Profile Management
^^^^^^^^^^^^^^^^^^

The tool allows to manage multiple profiles, e.g., with different home directories or ports.
See ``aiidalab-launch profiles --help`` for more information.

******************
AiiDAlab Home page
******************

When opening AiiDAlab you see a list of installed applications.
The front page is generated by the AiiDAlab home app which cannot be uninstalled.
Its main features are:

- **File manager**: manage files stored in the AiiDAlab home folder (including download/upload).
- **Terminal**: a standard Linux bash terminal.
- **Tasks**: view the currently running applications and stop them, if needed.
- **App Store**: install/remove applications.
- **Help**: links to the AiiDAlab documentation.


**************
App Management
**************

To install a new app, you can either open the Terminal and simply run ``aiiadalab install <app-name>``, where you replace ``<app-name>`` with the name of the app you would like to install (run ``aiidalab search`` to show a list of available apps), or, you use the app manager of the home app.

To use the app manager:

.. panels::
   :container: container-lg pb-3
   :column: col-lg-12 p-2

   **Step 1: Open the app manager.**

   Simply open AiiDAlab in the browser and click on the :fa:`puzzle-piece` icon in the top navigation bar.

   ---

   **Step 2: Search for the app you would like to install.**

   Optionally, filter by any of the presented categories,

   .. image:: ../_static/app-management-app-store.png

   and then scroll down until you find the app you would like to install.
   An app that is not installed yet, will be presented like this:

   .. image:: ../_static/app-management-app-not-installed.png

   Clicking on the **Install** button will install the app and its dependencies.

   ---

   **Step 3: Wait for the installation process to complete.**

   The current process for installing the app and its dependencies will be displayed via a terminal widget.
   Wait until the process has completed:

   .. image:: ../_static/app-management-app-instalation-finished.png

   ---

   **Step 4: Start the app from the start page.**

   The newly installed app should now show up on the start page.

   .. image:: ../_static/app-management-start-page.png

   Each app banner also shows an indicator about whether there is an update available (see screenshot above).
   To *update the app*, click on **Manage App** and then on the **Update**.
